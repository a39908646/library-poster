import{I,a2 as o,a3 as t,a4 as e,a8 as L,a6 as S,r as v,Z as a,a7 as l,ac as n,_ as d,ae as m,af as p,a5 as b,$ as i,ad as N,ab as H,a9 as T}from"./index-BZvRV0hf.js";import{N as C,a as w,R as V}from"./RefreshOutline-DtB_KKsC.js";import{u as $}from"./use-message-B96cpKcV.js";import{N as z}from"./Spin-CUfhFxuX.js";import{N as M}from"./Alert-DtZIvKKY.js";import{N as O,a as R,b as j}from"./Thing-CDb2VL8-.js";import{N as A}from"./Divider-D3XDjjRc.js";const Q={__name:"History",setup(E){const B=$(),u=v(!1),f=v({}),D=r=>r?new Date(r).toLocaleString("zh-CN"):"-",c=async()=>{u.value=!0;try{const r=await S.getHistory();f.value=r.history||{}}catch(r){B.error("加载历史记录失败: "+r.message)}finally{u.value=!1}};return I(()=>{c()}),(r,s)=>(a(),o(e(L),{title:"生成历史"},{default:t(()=>[l(e(z),{show:u.value},{default:t(()=>[Object.keys(f.value).length===0?(a(),o(e(M),{key:0,type:"info"},{default:t(()=>[...s[0]||(s[0]=[n(" 暂无生成历史记录 ",-1)])]),_:1})):(a(),o(e(C),{key:1},{default:t(()=>[(a(!0),d(m,null,p(f.value,(h,g)=>(a(),o(e(w),{key:g,title:`服务器: ${g}`},{default:t(()=>[l(e(C),null,{default:t(()=>[(a(!0),d(m,null,p(h,(x,y)=>(a(),o(e(w),{key:y,title:`媒体库 ID: ${y}`},{default:t(()=>[l(e(O),{bordered:""},{default:t(()=>[(a(!0),d(m,null,p(x,(_,k)=>(a(),o(e(R),{key:k},{default:t(()=>[l(e(j),null,{header:t(()=>[n("项目 ID: "+N(k),1)]),description:t(()=>[l(e(b),{vertical:"",size:"small"},{default:t(()=>[i("div",null,[s[1]||(s[1]=i("strong",null,"标签:",-1)),n(" "+N(_.tag),1)]),i("div",null,[s[2]||(s[2]=i("strong",null,"时间:",-1)),n(" "+N(D(_.timestamp)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))]),_:1},8,["show"]),l(e(A)),l(e(H),{onClick:c,loading:u.value},{icon:t(()=>[l(e(T),{component:e(V)},null,8,["component"])]),default:t(()=>[s[3]||(s[3]=n(" 刷新历史 ",-1))]),_:1},8,["loading"])]),_:1}))}};export{Q as default};
