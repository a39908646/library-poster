import{O as x,Q as o,R as t,T as e,Y as S,V as T,r as v,J as a,X as l,a0 as n,K as d,a2 as m,a3 as p,U as V,L as i,a1 as N,$ as H,Z as I}from"./index-DXdFuH5K.js";import{N as C,a as w,R as O}from"./RefreshOutline-DC7m93qa.js";import{u as R,N as $}from"./Spin-DElXLdiL.js";import{N as b}from"./Alert-DCbZTzLS.js";import{N as z,a as M,b as j}from"./Thing-DskFXyIs.js";import{N as A}from"./Divider-CM6gE9TA.js";const Y={__name:"History",setup(E){const B=R(),u=v(!1),f=v({}),D=r=>r?new Date(r).toLocaleString("zh-CN"):"-",c=async()=>{u.value=!0;try{const r=await T.getHistory();f.value=r.history||{}}catch(r){B.error("加载历史记录失败: "+r.message)}finally{u.value=!1}};return x(()=>{c()}),(r,s)=>(a(),o(e(S),{title:"生成历史"},{default:t(()=>[l(e($),{show:u.value},{default:t(()=>[Object.keys(f.value).length===0?(a(),o(e(b),{key:0,type:"info"},{default:t(()=>[...s[0]||(s[0]=[n(" 暂无生成历史记录 ",-1)])]),_:1})):(a(),o(e(C),{key:1},{default:t(()=>[(a(!0),d(m,null,p(f.value,(L,g)=>(a(),o(e(w),{key:g,title:`服务器: ${g}`},{default:t(()=>[l(e(C),null,{default:t(()=>[(a(!0),d(m,null,p(L,(h,y)=>(a(),o(e(w),{key:y,title:`媒体库 ID: ${y}`},{default:t(()=>[l(e(z),{bordered:""},{default:t(()=>[(a(!0),d(m,null,p(h,(_,k)=>(a(),o(e(M),{key:k},{default:t(()=>[l(e(j),null,{header:t(()=>[n("项目 ID: "+N(k),1)]),description:t(()=>[l(e(V),{vertical:"",size:"small"},{default:t(()=>[i("div",null,[s[1]||(s[1]=i("strong",null,"标签:",-1)),n(" "+N(_.tag),1)]),i("div",null,[s[2]||(s[2]=i("strong",null,"时间:",-1)),n(" "+N(D(_.timestamp)),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:1}))]),_:1},8,["show"]),l(e(A)),l(e(H),{onClick:c,loading:u.value},{icon:t(()=>[l(e(I),{component:e(O)},null,8,["component"])]),default:t(()=>[s[3]||(s[3]=n(" 刷新历史 ",-1))]),_:1},8,["loading"])]),_:1}))}};export{Y as default};
